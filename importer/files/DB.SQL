-- MySQL Script generated by MySQL Workbench
-- 11/29/16 18:20:16
-- Model: PRDKE    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema prdke
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema prdke
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `prdke` DEFAULT CHARACTER SET utf8 ;
USE `prdke` ;

-- -----------------------------------------------------
-- Table `prdke`.`USR`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `prdke`.`USR` ;

CREATE TABLE IF NOT EXISTS `prdke`.`USR` (
  `USR` VARCHAR(15) NOT NULL,
  PRIMARY KEY (`USR`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `prdke`.`Cases`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `prdke`.`Cases` ;

CREATE TABLE IF NOT EXISTS `prdke`.`Cases` (
  `CaseID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`CaseID`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `prdke`.`Kreditor`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `prdke`.`Kreditor` ;

CREATE TABLE IF NOT EXISTS `prdke`.`Kreditor` (
  `KredNr` INT NOT NULL,
  `Vname` VARCHAR(45) NULL,
  `Nname` VARCHAR(45) NULL,
  `Firma` VARCHAR(45) NULL,
  `PLZ` VARCHAR(20) NULL,
  `Ort` VARCHAR(45) NULL,
  `Land` VARCHAR(4) NULL,
  `SperrKZ` VARCHAR(45) NULL,
  `ErstellUSR` VARCHAR(15) NULL,
  `ErstellTS` DATETIME NULL,
  `CaseID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`KredNr`),
  INDEX `fk_Kreditor_USR1_idx` (`ErstellUSR` ASC),
  INDEX `fk_Kreditor_Case1_idx` (`CaseID` ASC),
  CONSTRAINT `fk_Kreditor_USR1`
    FOREIGN KEY (`ErstellUSR`)
    REFERENCES `prdke`.`USR` (`USR`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Kreditor_Case1`
    FOREIGN KEY (`CaseID`)
    REFERENCES `prdke`.`Cases` (`CaseID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `prdke`.`Bestellung`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `prdke`.`Bestellung` ;

CREATE TABLE IF NOT EXISTS `prdke`.`Bestellung` (
  `BestellNr` INT UNSIGNED NOT NULL,
  `KredNr` INT NULL,
  `StornoKZ` CHAR(1) NULL,
  `ErstellTS` DATETIME NULL,
  `ErstellUSR` VARCHAR(15) NULL,
  `FreigabeTS` DATETIME NULL,
  `FreigabeUSR` VARCHAR(15) NULL,
  `CaseID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`BestellNr`),
  INDEX `fk_Bestellung_Kreditor_idx` (`KredNr` ASC),
  INDEX `fk_Bestellung_USR1_idx` (`ErstellUSR` ASC),
  INDEX `fk_Bestellung_USR2_idx` (`FreigabeUSR` ASC),
  INDEX `fk_Bestellung_Case1_idx` (`CaseID` ASC),
  CONSTRAINT `fk_Bestellung_Kreditor`
    FOREIGN KEY (`KredNr`)
    REFERENCES `prdke`.`Kreditor` (`KredNr`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Bestellung_USR1`
    FOREIGN KEY (`ErstellUSR`)
    REFERENCES `prdke`.`USR` (`USR`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Bestellung_USR2`
    FOREIGN KEY (`FreigabeUSR`)
    REFERENCES `prdke`.`USR` (`USR`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Bestellung_Case1`
    FOREIGN KEY (`CaseID`)
    REFERENCES `prdke`.`Cases` (`CaseID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `prdke`.`Bestellposition`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `prdke`.`Bestellposition` ;

CREATE TABLE IF NOT EXISTS `prdke`.`Bestellposition` (
  `PosNr` SMALLINT NOT NULL,
  `BestellNr` INT UNSIGNED NULL,
  `MaterialNr` INT NULL,
  `Menge` SMALLINT NULL,
  `Meinheit` VARCHAR(15) NULL,
  `Preis` FLOAT NULL,
  `Waehrung` VARCHAR(5) NULL,
  `StornoKZ` CHAR(1) NULL,
  `ErstellTS` DATETIME NULL,
  `ErstellUSR` VARCHAR(15) NULL,
  `CaseID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`PosNr`, `BestellNr`),
  INDEX `fk_Bestellposition_Bestellung1_idx` (`BestellNr` ASC),
  INDEX `fk_Bestellposition_USR1_idx` (`ErstellUSR` ASC),
  INDEX `fk_Bestellposition_Case1_idx` (`CaseID` ASC),
  CONSTRAINT `fk_Bestellposition_Bestellung1`
    FOREIGN KEY (`BestellNr`)
    REFERENCES `prdke`.`Bestellung` (`BestellNr`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Bestellposition_USR1`
    FOREIGN KEY (`ErstellUSR`)
    REFERENCES `prdke`.`USR` (`USR`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Bestellposition_Case1`
    FOREIGN KEY (`CaseID`)
    REFERENCES `prdke`.`Cases` (`CaseID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `prdke`.`Wareneingang`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `prdke`.`Wareneingang` ;

CREATE TABLE IF NOT EXISTS `prdke`.`Wareneingang` (
  `ID` INT NOT NULL,
  `PosNr` SMALLINT NULL,
  `BestellNr` INT UNSIGNED NULL,
  `Menge` SMALLINT NULL,
  `Meinheit` VARCHAR(5) NULL,
  `EingangTS` DATETIME NULL,
  `EingangUSR` VARCHAR(15) NULL,
  `Kreditor_KredNr` INT NULL,
  `CaseID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ID`, `PosNr`, `BestellNr`),
  INDEX `fk_Wareneingang_Kreditor1_idx` (`Kreditor_KredNr` ASC),
  INDEX `fk_Wareneingang_Bestellposition1_idx` (`PosNr` ASC, `BestellNr` ASC),
  INDEX `fk_Wareneingang_USR1_idx` (`EingangUSR` ASC),
  INDEX `fk_Wareneingang_Case1_idx` (`CaseID` ASC),
  CONSTRAINT `fk_Wareneingang_Kreditor1`
    FOREIGN KEY (`Kreditor_KredNr`)
    REFERENCES `prdke`.`Kreditor` (`KredNr`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Wareneingang_Bestellposition1`
    FOREIGN KEY (`PosNr` , `BestellNr`)
    REFERENCES `prdke`.`Bestellposition` (`PosNr` , `BestellNr`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Wareneingang_USR1`
    FOREIGN KEY (`EingangUSR`)
    REFERENCES `prdke`.`USR` (`USR`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Wareneingang_Case1`
    FOREIGN KEY (`CaseID`)
    REFERENCES `prdke`.`Cases` (`CaseID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `prdke`.`Rechnung`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `prdke`.`Rechnung` ;

CREATE TABLE IF NOT EXISTS `prdke`.`Rechnung` (
  `RechNr` INT NOT NULL,
  `PosNr` SMALLINT NOT NULL,
  `BestellNr` INT UNSIGNED NOT NULL,
  `EingangsDat` DATETIME NULL,
  `RechnungsDatum` DATETIME NULL,
  `Betrag` FLOAT NULL,
  `Waehrung` VARCHAR(5) NULL,
  `KredNr` INT NULL,
  `CaseID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`RechNr`),
  INDEX `fk_Rechnung_Bestellposition1_idx` (`PosNr` ASC, `BestellNr` ASC),
  INDEX `fk_Rechnung_Kreditor1_idx` (`KredNr` ASC),
  INDEX `fk_Rechnung_Case1_idx` (`CaseID` ASC),
  CONSTRAINT `fk_Rechnung_Bestellposition1`
    FOREIGN KEY (`PosNr` , `BestellNr`)
    REFERENCES `prdke`.`Bestellposition` (`PosNr` , `BestellNr`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Rechnung_Kreditor1`
    FOREIGN KEY (`KredNr`)
    REFERENCES `prdke`.`Kreditor` (`KredNr`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Rechnung_Case1`
    FOREIGN KEY (`CaseID`)
    REFERENCES `prdke`.`Cases` (`CaseID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `prdke`.`Zahlung`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `prdke`.`Zahlung` ;

CREATE TABLE IF NOT EXISTS `prdke`.`Zahlung` (
  `ID` INT NOT NULL,
  `RechNr` INT NULL,
  `Betrag` FLOAT NULL,
  `Waehrung` VARCHAR(5) NULL,
  `ZahlTS` DATETIME NULL,
  `ZahlUSR` VARCHAR(15) NULL,
  `KredNr` INT NULL,
  `CaseID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ID`),
  INDEX `fk_Zahlung_Rechnung1_idx` (`RechNr` ASC),
  INDEX `fk_Zahlung_USR1_idx` (`ZahlUSR` ASC),
  INDEX `fk_Zahlung_Kreditor1_idx` (`KredNr` ASC),
  INDEX `fk_Zahlung_Case1_idx` (`CaseID` ASC),
  CONSTRAINT `fk_Zahlung_Rechnung1`
    FOREIGN KEY (`RechNr`)
    REFERENCES `prdke`.`Rechnung` (`RechNr`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Zahlung_USR1`
    FOREIGN KEY (`ZahlUSR`)
    REFERENCES `prdke`.`USR` (`USR`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Zahlung_Kreditor1`
    FOREIGN KEY (`KredNr`)
    REFERENCES `prdke`.`Kreditor` (`KredNr`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Zahlung_Case1`
    FOREIGN KEY (`CaseID`)
    REFERENCES `prdke`.`Cases` (`CaseID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `prdke`.`Aenderungshistorie`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `prdke`.`Aenderungshistorie` ;

CREATE TABLE IF NOT EXISTS `prdke`.`Aenderungshistorie` (
  `AenderNr` INT UNSIGNED NOT NULL,
  `Tabelle` VARCHAR(20) NULL,
  `Feld` VARCHAR(20) NULL,
  `ID` INT UNSIGNED NULL,
  `Wert_alt` VARCHAR(45) NULL,
  `Wert_neu` VARCHAR(45) NULL,
  `AenderTS` DATETIME NULL,
  `AenderUSR` VARCHAR(15) NULL,
  `CaseID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`AenderNr`),
  INDEX `fk_Aenderungshistorie_USR1_idx` (`AenderUSR` ASC),
  INDEX `fk_Aenderungshistorie_Case1_idx` (`CaseID` ASC),
  CONSTRAINT `fk_Aenderungshistorie_USR1`
    FOREIGN KEY (`AenderUSR`)
    REFERENCES `prdke`.`USR` (`USR`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Aenderungshistorie_Case1`
    FOREIGN KEY (`CaseID`)
    REFERENCES `prdke`.`Cases` (`CaseID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `prdke`.`Aktivitaeten`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `prdke`.`Aktivitaeten` ;

CREATE TABLE IF NOT EXISTS `prdke`.`Aktivitaeten` (
  `ID` INT NOT NULL,
  `Aktivitaet` VARCHAR(45) NULL,
  `tabelle` VARCHAR(20) NULL,
  `spalte1` VARCHAR(20) NULL,
  `wert1` VARCHAR(20) NULL,
  `spalte1` VARCHAR(20) NULL,
  `wert2` VARCHAR(20) NULL,
  `spalte3` VARCHAR(20) NULL,
  `wert3` VARCHAR(20) NULL,
  `TSFeld` VARCHAR(20) NULL,
  PRIMARY KEY (`ID`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `prdke`.`Eventlog`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `prdke`.`Eventlog` ;

CREATE TABLE IF NOT EXISTS `prdke`.`Eventlog` (
  `EventlogID` INT NOT NULL AUTO_INCREMENT,
  `EventID` INT NULL,
  `Timestamp` DATETIME NULL,
  `Aktivitaeten_ID` INT NOT NULL,
  `CaseID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`EventlogID`),
  INDEX `fk_Eventlog_Aktivitaeten1_idx` (`Aktivitaeten_ID` ASC),
  INDEX `fk_Eventlog_Case1_idx` (`CaseID` ASC),
  CONSTRAINT `fk_Eventlog_Aktivitaeten1`
    FOREIGN KEY (`Aktivitaeten_ID`)
    REFERENCES `prdke`.`Aktivitaeten` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Eventlog_Case1`
    FOREIGN KEY (`CaseID`)
    REFERENCES `prdke`.`Cases` (`CaseID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `prdke`.`Prozessvarianten`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `prdke`.`Prozessvarianten` ;

CREATE TABLE IF NOT EXISTS `prdke`.`Prozessvarianten` (
  `ProzessvariantenID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `Haeufigkeit` INT UNSIGNED NULL,
  `Durchlaufzeit` INT NULL,
  PRIMARY KEY (`ProzessvariantenID`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `prdke`.`Prozessteilschritte`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `prdke`.`Prozessteilschritte` ;

CREATE TABLE IF NOT EXISTS `prdke`.`Prozessteilschritte` (
  `ProzessteilschrittID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `Durchlaufzeit` INT NULL,
  `Haeufigkeit` INT NULL,
  `Knotentyp` SET('Start', 'Standard', 'End') NULL,
  `Aktivitaeten_ID` INT NOT NULL,
  `NachfolgerID` INT NULL,
  `ProzessvariantenID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ProzessteilschrittID`, `ProzessvariantenID`),
  INDEX `fk_Prozessvarianten_Aktivitaeten1_idx` (`Aktivitaeten_ID` ASC),
  INDEX `fk_Prozessteilschritte_Prozessvarianten1_idx` (`ProzessvariantenID` ASC),
  CONSTRAINT `fk_Prozessvarianten_Aktivitaeten1`
    FOREIGN KEY (`Aktivitaeten_ID`)
    REFERENCES `prdke`.`Aktivitaeten` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Prozessteilschritte_Prozessvarianten1`
    FOREIGN KEY (`ProzessvariantenID`)
    REFERENCES `prdke`.`Prozessvarianten` (`ProzessvariantenID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

